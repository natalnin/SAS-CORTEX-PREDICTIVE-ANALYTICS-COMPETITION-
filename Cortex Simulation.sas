*------------------------------------------------------------*;
* EM Version: 14.2;
* SAS Release: 9.04.01M4P110916;
* Host: SASBAP;
* Project Path: d:\ERPsim-EDGE;
* Project Name: Fundraising Simulation;
* Diagram Id: EMWS28;
* Diagram Name: Round 1 -- Amount;
* Generated by: sasdemo;
* Date: 17JUN2020:20:16:19;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* Macro Variables;
*------------------------------------------------------------*;
%let EM_PROJECT =;
%let EM_PROJECTNAME =;
%let EM_WSNAME =;
%let EM_WSDESCRIPTION =Round 1 -- Amount;
%let EM_SUMMARY =WORK.SUMMARY;
%let EM_NUMTASKS =SINGLE;
%let EM_EDITMODE =R;
%let EM_DEBUGVAL =;
%let EM_ACTION =run;
*------------------------------------------------------------*;
%macro em_usedatatable;
%if ^%symexist(EM_USEDATATABLE) %then %do;
%let EM_USEDATATABLE = Y;
%end;
%if "&EM_USEDATATABLE" ne "N" %then %do;
%global Ids4_data Ids4_newdata;
%global Ids3_data Ids3_newdata;
%global Ids2_data Ids2_newdata;
%global Ids_data Ids_newdata;
*------------------------------------------------------------*;
* Data Tables;
*------------------------------------------------------------*;
%let Ids4_data = SIMDATA.SCORE_RD1;
%let Ids4_newdata =;
%let Ids3_data = SIMDATA.TARGET_RD1;
%let Ids3_newdata =;
%let Ids2_data = SIMDATA.SCORE;
%let Ids2_newdata =;
%let Ids_data = SIMDATA.HIST;
%let Ids_newdata =;
*------------------------------------------------------------*;
%end;
%global Ids4_source;
%if "&Ids4_newdata" ne "" %then %do;
%let Ids4_source = USERTABLE;
%end;
%else %do;
%let Ids4_source = DATASOURCE;
%end;
%global Ids3_source;
%if "&Ids3_newdata" ne "" %then %do;
%let Ids3_source = USERTABLE;
%end;
%else %do;
%let Ids3_source = DATASOURCE;
%end;
%global Ids2_source;
%if "&Ids2_newdata" ne "" %then %do;
%let Ids2_source = USERTABLE;
%end;
%else %do;
%let Ids2_source = DATASOURCE;
%end;
%global Ids_source;
%if "&Ids_newdata" ne "" %then %do;
%let Ids_source = USERTABLE;
%end;
%else %do;
%let Ids_source = DATASOURCE;
%end;
%mend em_usedatatable;
%em_usedatatable;
*------------------------------------------------------------*;
* Create workspace data set;
*------------------------------------------------------------*;
data workspace;
length property $64 value $200;
property= 'PROJECTLOCATION';
value= "&EM_PROJECT";
output;
property= 'PROJECTNAME';
value= "&EM_PROJECTNAME";
output;
property= 'WORKSPACENAME';
value= "&EM_WSNAME";
output;
property= 'WORKSPACEDESCRIPTION';
value= "&EM_WSDESCRIPTION";
output;
property= 'SUMMARYDATASET';
value= "&EM_SUMMARY";
output;
property= 'NUMTASKS';
value= "&EM_NUMTASKS";
output;
property= 'EDITMODE';
value= "&EM_EDITMODE";
output;
property= 'DEBUG';
value= "&EM_DEBUGVAL";
output;
run;
*------------------------------------------------------------*;
* Create nodes data set;
*------------------------------------------------------------*;
data nodes;
length id $12 component $32 description $64 X 8 Y 8 diagramID $32 parentID $32;
id= "Tree";
component="DecisionTree";
description= "Decision Tree";
diagramID="_ROOT_";
parentID="";
X=528;
Y=163;
output;
id= "Trans";
component="Transform";
description= "Transform Variables";
diagramID="_ROOT_";
parentID="";
X=237;
Y=112;
output;
id= "Score";
component="Score";
description= "Scoring";
diagramID="_ROOT_";
parentID="";
X=1016;
Y=125;
output;
id= "Reg";
component="Regression";
description= "Regression";
diagramID="_ROOT_";
parentID="";
X=528;
Y=89;
output;
id= "Part";
component="Partition";
description= "Data Partition";
diagramID="_ROOT_";
parentID="";
X=395;
Y=201;
output;
id= "Merge2";
component="Merge";
description= "Merge (score)";
diagramID="_ROOT_";
parentID="";
X=854;
Y=48;
output;
id= "Merge";
component="Merge";
description= "Merge";
diagramID="_ROOT_";
parentID="";
X=197;
Y=38;
output;
id= "MdlComp";
component="ModelCompare";
description= "Model Comparison";
diagramID="_ROOT_";
parentID="";
X=709;
Y=125;
output;
id= "Impt";
component="Impute";
description= "Impute";
diagramID="_ROOT_";
parentID="";
X=233;
Y=198;
output;
id= "Ids4";
component="DataSource";
description= "SCORE_RD1";
diagramID="_ROOT_";
parentID="";
X=708;
Y=75;
output;
id= "Ids3";
component="DataSource";
description= "TARGET_RD1_AMOUNT";
diagramID="_ROOT_";
parentID="";
X=42;
Y=148;
output;
id= "Ids2";
component="DataSource";
description= "SCORE";
diagramID="_ROOT_";
parentID="";
X=708;
Y=24;
output;
id= "Ids";
component="DataSource";
description= "HIST";
diagramID="_ROOT_";
parentID="";
X=43;
Y=99;
output;
id= "EMCODE";
component="SASCode";
description= "SAS Code";
diagramID="_ROOT_";
parentID="";
X=1178;
Y=125;
output;
id= "AutoNeural";
component="AutoNeural";
description= "AutoNeural";
diagramID="_ROOT_";
parentID="";
X=560;
Y=248;
output;
run;
*------------------------------------------------------------*;
* DataSource Properties;
*------------------------------------------------------------*;
data WORK.hist_P;
  length   Property                         $ 32
           Value                            $ 200
           ;

Property="Name";
Value="HIST";
output;
Property="CreateDate";
Value="1864293809.3";
output;
Property="ModifyDate";
Value="1864293809.4";
output;
Property="CreatedBy";
Value="11131726";
output;
Property="ModifiedBy";
Value="11131726";
output;
Property="SampleSizeType";
Value="";
output;
Property="SampleSize";
Value="";
output;
;
run;
*------------------------------------------------------------*;
* DataSource Properties;
*------------------------------------------------------------*;
data WORK.score_P;
  length   Property                         $ 32
           Value                            $ 200
           ;

Property="Name";
Value="SCORE";
output;
Property="CreateDate";
Value="1864293868.3";
output;
Property="ModifyDate";
Value="1864293868.4";
output;
Property="CreatedBy";
Value="11131726";
output;
Property="ModifiedBy";
Value="11131726";
output;
Property="SampleSizeType";
Value="";
output;
Property="SampleSize";
Value="";
output;
;
run;
*------------------------------------------------------------*;
* DataSource Properties;
*------------------------------------------------------------*;
data WORK.targetrdamount_P;
  length   Property                         $ 32
           Value                            $ 200
           ;

Property="Name";
Value="TARGET_RD1_AMOUNT";
output;
Property="CreateDate";
Value="1864293934.7";
output;
Property="ModifyDate";
Value="1864293934.7";
output;
Property="CreatedBy";
Value="11131726";
output;
Property="ModifiedBy";
Value="11131726";
output;
Property="SampleSizeType";
Value="";
output;
Property="SampleSize";
Value="";
output;
;
run;
*------------------------------------------------------------*;
* DataSource Properties;
*------------------------------------------------------------*;
data WORK.scorerd_P;
  length   Property                         $ 32
           Value                            $ 200
           ;

Property="Name";
Value="SCORE_RD1";
output;
Property="CreateDate";
Value="1864294749.1";
output;
Property="ModifyDate";
Value="1864294749.2";
output;
Property="CreatedBy";
Value="11131726";
output;
Property="ModifiedBy";
Value="11131726";
output;
Property="SampleSizeType";
Value="";
output;
Property="SampleSize";
Value="";
output;
;
run;
*------------------------------------------------------------*;
* Decmeta Data Set for Tree;
*------------------------------------------------------------*;
data WORK.Tree_AmtThisYear_DM;
  length   _TYPE_                           $ 32
           VARIABLE                         $ 32
           LABEL                            $ 256
           FORMAT                           $ 32
           LEVEL                            $ 32
           TYPE                             $ 1
           COST                             $ 32
           USE                              $ 1
           MIN                                8
           MEAN                               8
           MAX                                8
           ;

  label    _TYPE_="Type"
           VARIABLE="Variable"
           LABEL="Label"
           FORMAT="Format"
           LEVEL="Measurement Level"
           TYPE="Type"
           COST="Cost"
           USE="Use"
           MIN="Minimum"
           MEAN="Mean"
           MAX="Maximum"
           ;
_TYPE_="MATRIX";
VARIABLE="";
LABEL="";
FORMAT="";
LEVEL="PROFIT";
TYPE="";
COST="";
USE="N";
MIN=.;
MEAN=.;
MAX=.;
output;
_TYPE_="TARGET";
VARIABLE="AmtThisYear";
LABEL="";
FORMAT="BEST12.0";
LEVEL="INTERVAL";
TYPE="N";
COST="";
USE="";
MIN=0;
MEAN=7.883975;
MAX=10000;
output;
_TYPE_="PREDICTED";
VARIABLE="P_AmtThisYear";
LABEL="Predicted: AmtThisYear";
FORMAT="";
LEVEL="";
TYPE="N";
COST="";
USE="";
MIN=.;
MEAN=.;
MAX=.;
output;
_TYPE_="RESIDUAL";
VARIABLE="R_AmtThisYear";
LABEL="Residual: AmtThisYear";
FORMAT="";
LEVEL="";
TYPE="N";
COST="";
USE="";
MIN=.;
MEAN=.;
MAX=.;
output;
;
run;
*------------------------------------------------------------*;
* Decdata Data Set for Tree;
*------------------------------------------------------------*;
data WORK.Tree_AmtThisYear_DD(label="AmtThisYear");
  length   AmtThisYear                        8
           ;

AmtThisYear=0;
output;
AmtThisYear=10000;
output;
AmtThisYear=7.883975;
output;
;
run;
*------------------------------------------------------------*;
* USERTRAINCODE File for Tree;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Tree_USERTRAINCODE.sas";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath";
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for Tree;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Tree_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Variable Attributes for Trans;
*------------------------------------------------------------*;
data WORK.Trans_VariableAttribute;
length Variable $64 AttributeName $32 AttributeValue $64;
Variable='Referrals';
AttributeName="METHOD";
AttributeValue='LOG10';
Output;
Variable='Salary';
AttributeName="METHOD";
AttributeValue='LOG10';
Output;
run;
*------------------------------------------------------------*;
* INTERACTION Data Set for Trans;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* FORMULA Data Set for Trans;
*------------------------------------------------------------*;
*------------------------------------------------------------*;
* EMNOTES File for Trans;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Trans_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for Score;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Score_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Decmeta Data Set for Reg;
*------------------------------------------------------------*;
data WORK.Reg_AmtThisYear_DM;
  length   _TYPE_                           $ 32
           VARIABLE                         $ 32
           LABEL                            $ 256
           FORMAT                           $ 32
           LEVEL                            $ 32
           TYPE                             $ 1
           COST                             $ 32
           USE                              $ 1
           MIN                                8
           MEAN                               8
           MAX                                8
           ;

  label    _TYPE_="Type"
           VARIABLE="Variable"
           LABEL="Label"
           FORMAT="Format"
           LEVEL="Measurement Level"
           TYPE="Type"
           COST="Cost"
           USE="Use"
           MIN="Minimum"
           MEAN="Mean"
           MAX="Maximum"
           ;
_TYPE_="MATRIX";
VARIABLE="";
LABEL="";
FORMAT="";
LEVEL="PROFIT";
TYPE="";
COST="";
USE="N";
MIN=.;
MEAN=.;
MAX=.;
output;
_TYPE_="TARGET";
VARIABLE="AmtThisYear";
LABEL="";
FORMAT="BEST12.0";
LEVEL="INTERVAL";
TYPE="N";
COST="";
USE="";
MIN=0;
MEAN=7.883975;
MAX=10000;
output;
_TYPE_="PREDICTED";
VARIABLE="P_AmtThisYear";
LABEL="Predicted: AmtThisYear";
FORMAT="";
LEVEL="";
TYPE="N";
COST="";
USE="";
MIN=.;
MEAN=.;
MAX=.;
output;
_TYPE_="RESIDUAL";
VARIABLE="R_AmtThisYear";
LABEL="Residual: AmtThisYear";
FORMAT="";
LEVEL="";
TYPE="N";
COST="";
USE="";
MIN=.;
MEAN=.;
MAX=.;
output;
;
run;
*------------------------------------------------------------*;
* Decdata Data Set for Reg;
*------------------------------------------------------------*;
data WORK.Reg_AmtThisYear_DD(label="AmtThisYear");
  length   AmtThisYear                        8
           ;

AmtThisYear=0;
output;
AmtThisYear=10000;
output;
AmtThisYear=7.883975;
output;
;
run;
*------------------------------------------------------------*;
* EMNOTES File for Reg;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Reg_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for Part;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Part_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for Merge2;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Merge2_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for Merge;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Merge_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for MdlComp;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"MdlComp_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for Impt;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Impt_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* EMNOTES File for Ids4;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Ids4_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Variable Attributes for Ids3;
*------------------------------------------------------------*;
data WORK.Ids3_VariableAttribute;
length Variable $64 AttributeName $32 AttributeValue $64;
Variable='AmtThisYear';
AttributeName="ROLE";
AttributeValue='TARGET';
Output;
Variable='GaveThisYear';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='GaveThisYear';
AttributeName="LEVEL";
AttributeValue='BINARY';
Output;
run;
*------------------------------------------------------------*;
* Decmeta Data Set for Ids3;
*------------------------------------------------------------*;
data WORK.Ids3_AmtThisYear_DM;
  length   _TYPE_                           $ 32
           VARIABLE                         $ 32
           LABEL                            $ 256
           FORMAT                           $ 32
           LEVEL                            $ 32
           TYPE                             $ 1
           COST                             $ 32
           USE                              $ 1
           MIN                                8
           MEAN                               8
           MAX                                8
           ;

  label    _TYPE_="Type"
           VARIABLE="Variable"
           LABEL="Label"
           FORMAT="Format"
           LEVEL="Measurement Level"
           TYPE="Type"
           COST="Cost"
           USE="Use"
           MIN="Minimum"
           MEAN="Mean"
           MAX="Maximum"
           ;
_TYPE_="MATRIX";
VARIABLE="";
LABEL="";
FORMAT="";
LEVEL="PROFIT";
TYPE="";
COST="";
USE="N";
MIN=.;
MEAN=.;
MAX=.;
output;
_TYPE_="TARGET";
VARIABLE="AmtThisYear";
LABEL="";
FORMAT="BEST12.0";
LEVEL="INTERVAL";
TYPE="N";
COST="";
USE="";
MIN=0;
MEAN=8.1669;
MAX=10000;
output;
_TYPE_="PREDICTED";
VARIABLE="P_AmtThisYear";
LABEL="Valeur prédite : AmtThisYear";
FORMAT="";
LEVEL="";
TYPE="N";
COST="";
USE="";
MIN=.;
MEAN=.;
MAX=.;
output;
_TYPE_="RESIDUAL";
VARIABLE="R_AmtThisYear";
LABEL="Residual: AmtThisYear";
FORMAT="";
LEVEL="";
TYPE="N";
COST="";
USE="";
MIN=.;
MEAN=.;
MAX=.;
output;
;
run;
*------------------------------------------------------------*;
* Decdata Data Set for Ids3;
*------------------------------------------------------------*;
data WORK.Ids3_AmtThisYear_DD;
  length   AmtThisYear                        8
           ;

AmtThisYear=0;
output;
AmtThisYear=10000;
output;
AmtThisYear=5000;
output;
;
run;
*------------------------------------------------------------*;
* EMNOTES File for Ids3;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Ids3_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Variable Attributes for Ids2;
*------------------------------------------------------------*;
data WORK.Ids2_VariableAttribute;
length Variable $64 AttributeName $32 AttributeValue $64;
Variable='FirstName';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='Frequency';
AttributeName="ROLE";
AttributeValue='INPUT';
Output;
Variable='LastName';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='Woman';
AttributeName="LEVEL";
AttributeValue='BINARY';
Output;
run;
*------------------------------------------------------------*;
* EMNOTES File for Ids2;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Ids2_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Variable Attributes for Ids;
*------------------------------------------------------------*;
data WORK.Ids_VariableAttribute;
length Variable $64 AttributeName $32 AttributeValue $64;
Variable='FirstName';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='Frequency';
AttributeName="ROLE";
AttributeValue='INPUT';
Output;
Variable='GaveLastYear';
AttributeName="LEVEL";
AttributeValue='BINARY';
Output;
Variable='LastName';
AttributeName="ROLE";
AttributeValue='REJECTED';
Output;
Variable='Woman';
AttributeName="LEVEL";
AttributeValue='BINARY';
Output;
run;
*------------------------------------------------------------*;
* EMNOTES File for Ids;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"Ids_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* USERTRAINCODE File for EMCODE;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"EMCODE_USERTRAINCODE.sas";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath";
file dspath;
run;
*------------------------------------------------------------*;
* USERREPORTCODE File for EMCODE;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"EMCODE_USERREPORTCODE.sas";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath";
file dspath;
put 'data tmp;';
put '  set &EM_LIB..Score_variableset;';
put '  where Role="TARGET";';
put '  call symput("VARCIBLE",name);';
put 'run;';
put ' ';
put 'data contact;';
put '  set &em_lib..score_score;';
put '  Gave=GaveLastYear;';
put '  AmtGave=AmtLastYear;';
put '  Prediction=P_&VARCIBLE.;';
put '  keep id Prediction Gave AmtGave;';
put ' ';
put 'proc export data=contact dbms=xlsx';
put '  outfile="d:\ERPsim-EDGE\ScoredOutput\Round 1 -- Amount.xlsx"';
put '  replace;';
put 'run;';
put ' ';
put ' ';
put ' ';
put ' ';
put ' ';
put ' ';
put ' ';
run;
*------------------------------------------------------------*;
* EMNOTES File for EMCODE;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"EMCODE_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Decmeta Data Set for AutoNeural;
*------------------------------------------------------------*;
data WORK.AutoNeural_AmtThisYear_DM;
  length   _TYPE_                           $ 32
           VARIABLE                         $ 32
           LABEL                            $ 256
           FORMAT                           $ 32
           LEVEL                            $ 32
           TYPE                             $ 1
           COST                             $ 32
           USE                              $ 1
           MIN                                8
           MEAN                               8
           MAX                                8
           ;

  label    _TYPE_="Type"
           VARIABLE="Variable"
           LABEL="Label"
           FORMAT="Format"
           LEVEL="Measurement Level"
           TYPE="Type"
           COST="Cost"
           USE="Use"
           MIN="Minimum"
           MEAN="Mean"
           MAX="Maximum"
           ;
_TYPE_="MATRIX";
VARIABLE="";
LABEL="";
FORMAT="";
LEVEL="PROFIT";
TYPE="";
COST="";
USE="N";
MIN=.;
MEAN=.;
MAX=.;
output;
_TYPE_="TARGET";
VARIABLE="AmtThisYear";
LABEL="";
FORMAT="BEST12.0";
LEVEL="INTERVAL";
TYPE="N";
COST="";
USE="";
MIN=0;
MEAN=7.883975;
MAX=10000;
output;
_TYPE_="PREDICTED";
VARIABLE="P_AmtThisYear";
LABEL="Predicted: AmtThisYear";
FORMAT="";
LEVEL="";
TYPE="N";
COST="";
USE="";
MIN=.;
MEAN=.;
MAX=.;
output;
_TYPE_="RESIDUAL";
VARIABLE="R_AmtThisYear";
LABEL="Residual: AmtThisYear";
FORMAT="";
LEVEL="";
TYPE="N";
COST="";
USE="";
MIN=.;
MEAN=.;
MAX=.;
output;
;
run;
*------------------------------------------------------------*;
* Decdata Data Set for AutoNeural;
*------------------------------------------------------------*;
data WORK.AutoNeural_AmtThisYear_DD(label="AmtThisYear");
  length   AmtThisYear                        8
           ;

AmtThisYear=0;
output;
AmtThisYear=10000;
output;
AmtThisYear=7.883975;
output;
;
run;
*------------------------------------------------------------*;
* EMNOTES File for AutoNeural;
*------------------------------------------------------------*;
data _null_;
if symget('sysscp')=:'WIN' then dsep='\';
else if symget('sysscp')=:'DNT' then dsep='\';
else dsep = '/';
filepath = pathname('work')!!dsep!!"AutoNeural_EMNOTES.txt";
call symput('DSPATH', filepath);
run;
data _null_;
filename dspath "&dspath" encoding="utf-8" NOBOM;
file dspath;
run;
*------------------------------------------------------------*;
* Create node properties data set;
*------------------------------------------------------------*;
data nodeprops;
length id $12 property $64 value $400;
id= "Tree";
property="Location";
value= "CATALOG";
output;
id= "Tree";
property="Catalog";
value= "SASHELP.EMMODL.TREE.SOURCE";
output;
id= "Tree";
property="ToolType";
value= "MODEL";
output;
id= "Tree";
property="TrainMode";
value= "BATCH";
output;
id= "Tree";
property="ImportModel";
value= "N";
output;
id= "Tree";
property="Freeze";
value= "N";
output;
id= "Tree";
property="UseMultipleTarget";
value= "N";
output;
id= "Tree";
property="Precision";
value= "4";
output;
id= "Tree";
property="IntervalCriterion";
value= "PROBF";
output;
id= "Tree";
property="NominalCriterion";
value= "PROBCHISQ";
output;
id= "Tree";
property="OrdinalCriterion";
value= "ENTROPY";
output;
id= "Tree";
property="SigLevel";
value= "0.2";
output;
id= "Tree";
property="Splitsize";
value= ".";
output;
id= "Tree";
property="LeafSize";
value= "5";
output;
id= "Tree";
property="MinCatSize";
value= "5";
output;
id= "Tree";
property="Maxbranch";
value= "2";
output;
id= "Tree";
property="Maxdepth";
value= "2";
output;
id= "Tree";
property="Nrules";
value= "5";
output;
id= "Tree";
property="Nsurrs";
value= "0";
output;
id= "Tree";
property="MissingValue";
value= "USEINSEARCH";
output;
id= "Tree";
property="UseVarOnce";
value= "N";
output;
id= "Tree";
property="SplitPrecision";
value= "4";
output;
id= "Tree";
property="Subtree";
value= "ASSESSMENT";
output;
id= "Tree";
property="NSubtree";
value= "1";
output;
id= "Tree";
property="AssessMeasure";
value= "PROFIT/LOSS";
output;
id= "Tree";
property="AssessPercentage";
value= "0.25";
output;
id= "Tree";
property="NodeSample";
value= "20000";
output;
id= "Tree";
property="Exhaustive";
value= "5000";
output;
id= "Tree";
property="Kass";
value= "Y";
output;
id= "Tree";
property="KassApply";
value= "BEFORE";
output;
id= "Tree";
property="Depth";
value= "Y";
output;
id= "Tree";
property="Inputs";
value= "N";
output;
id= "Tree";
property="NumInputs";
value= "1";
output;
id= "Tree";
property="VarSelection";
value= "Y";
output;
id= "Tree";
property="Leafid";
value= "Y";
output;
id= "Tree";
property="NodeRole";
value= "SEGMENT";
output;
id= "Tree";
property="Performance";
value= "DISK";
output;
id= "Tree";
property="CV";
value= "N";
output;
id= "Tree";
property="CVNIter";
value= "10";
output;
id= "Tree";
property="CVRepeat";
value= "1";
output;
id= "Tree";
property="CVSeed";
value= "12345";
output;
id= "Tree";
property="ObsImportance";
value= "N";
output;
id= "Tree";
property="NumSingleImp";
value= "5";
output;
id= "Tree";
property="UseDecision";
value= "N";
output;
id= "Tree";
property="UsePriors";
value= "N";
output;
id= "Tree";
property="ClassColorBy";
value= "PERCENTCORRECT";
output;
id= "Tree";
property="IntColorBy";
value= "AVG";
output;
id= "Tree";
property="ShowNodeId";
value= "Y";
output;
id= "Tree";
property="ShowValid";
value= "Y";
output;
id= "Tree";
property="Pred";
value= "N";
output;
id= "Tree";
property="Target";
value= "ALL";
output;
id= "Tree";
property="Count";
value= "Y";
output;
id= "Tree";
property="ProfitLoss";
value= "NONE";
output;
id= "Tree";
property="PercentCorrect";
value= "N";
output;
id= "Tree";
property="AVG";
value= "Y";
output;
id= "Tree";
property="RASE";
value= "N";
output;
id= "Tree";
property="CreateSample";
value= "DEFAULT";
output;
id= "Tree";
property="SampleMethod";
value= "RANDOM";
output;
id= "Tree";
property="SampleSize";
value= "10000";
output;
id= "Tree";
property="SampleSeed";
value= "12345";
output;
id= "Tree";
property="ForceRun";
value= "N";
output;
id= "Tree";
property="RunAction";
value= "Train";
output;
id= "Tree";
property="Component";
value= "DecisionTree";
output;
id= "Tree";
property="Criterion";
value= "DEFAULT";
output;
id= "Tree";
property="Dummy";
value= "N";
output;
id= "Tree";
property="Predict";
value= "Y";
output;
id= "Tree";
property="ImportedTreeData";
value= "";
output;
id= "Tree";
property="ToolPrefix";
value= "Tree";
output;
id= "Tree";
property="EM_DECMETA_AmtThisYear";
value= "WORK.Tree_AmtThisYear_DM";
output;
id= "Tree";
property="EM_DECDATA_AmtThisYear";
value= "WORK.Tree_AmtThisYear_DD";
output;
id= "Tree";
property="EM_FILE_USERTRAINCODE";
value= "Tree_USERTRAINCODE.sas";
output;
id= "Tree";
property="EM_FILE_EMNOTES";
value= "Tree_EMNOTES.txt";
output;
id= "Trans";
property="DefaultMethod";
value= "NONE";
output;
id= "Trans";
property="DefaultTargetMethod";
value= "NONE";
output;
id= "Trans";
property="DefaultClassMethod";
value= "NONE";
output;
id= "Trans";
property="DefaultClassTargetMethod";
value= "NONE";
output;
id= "Trans";
property="Offset";
value= "1";
output;
id= "Trans";
property="MinOffset";
value= "Y";
output;
id= "Trans";
property="HideVariable";
value= "Y";
output;
id= "Trans";
property="RejectVariable";
value= "Y";
output;
id= "Trans";
property="GroupCutoff";
value= "0.1";
output;
id= "Trans";
property="GroupMissing";
value= "N";
output;
id= "Trans";
property="EmRandomSeed";
value= "12345";
output;
id= "Trans";
property="EmSampleSize";
value= "DEFAULT";
output;
id= "Trans";
property="EmSampleMethod";
value= "FIRSTN";
output;
id= "Trans";
property="MissingValue";
value= "USEINSEARCH";
output;
id= "Trans";
property="SummaryVariables";
value= "TRANSFORMED";
output;
id= "Trans";
property="SummaryStatistics";
value= "Y";
output;
id= "Trans";
property="UseMetaTransform";
value= "Y";
output;
id= "Trans";
property="MissingAsLevel";
value= "N";
output;
id= "Trans";
property="NumberofBins";
value= "VARIABLES";
output;
id= "Trans";
property="MaxOptimalBins";
value= "4";
output;
id= "Trans";
property="ForceRun";
value= "N";
output;
id= "Trans";
property="RunAction";
value= "Train";
output;
id= "Trans";
property="Component";
value= "Transform";
output;
id= "Trans";
property="EM_VARIABLEATTRIBUTES";
value= "WORK.Trans_VariableAttribute";
output;
id= "Trans";
property="EM_FILE_EMNOTES";
value= "Trans_EMNOTES.txt";
output;
id= "Score";
property="OutputType";
value= "VIEW";
output;
id= "Score";
property="FixedOutputNames";
value= "N";
output;
id= "Score";
property="HideVariables";
value= "Y";
output;
id= "Score";
property="HideInput";
value= "Y";
output;
id= "Score";
property="HideTarget";
value= "Y";
output;
id= "Score";
property="HideRejected";
value= "Y";
output;
id= "Score";
property="HideAssess";
value= "Y";
output;
id= "Score";
property="HidePredict";
value= "Y";
output;
id= "Score";
property="HideFreq";
value= "Y";
output;
id= "Score";
property="HideClassification";
value= "Y";
output;
id= "Score";
property="HideResidual";
value= "Y";
output;
id= "Score";
property="HideOther";
value= "Y";
output;
id= "Score";
property="ScoreValidate";
value= "N";
output;
id= "Score";
property="ScoreTest";
value= "N";
output;
id= "Score";
property="CScore";
value= "N";
output;
id= "Score";
property="JScore";
value= "N";
output;
id= "Score";
property="PackageName";
value= "DEFAULT";
output;
id= "Score";
property="UserPackageName";
value= "";
output;
id= "Score";
property="PreferenceName";
value= "";
output;
id= "Score";
property="OptimizedCode";
value= "Y";
output;
id= "Score";
property="GraphReports";
value= "Y";
output;
id= "Score";
property="ForceRun";
value= "N";
output;
id= "Score";
property="RunAction";
value= "Train";
output;
id= "Score";
property="Component";
value= "Score";
output;
id= "Score";
property="EM_FILE_EMNOTES";
value= "Score_EMNOTES.txt";
output;
id= "Reg";
property="MainEffect";
value= "Y";
output;
id= "Reg";
property="TwoFactor";
value= "N";
output;
id= "Reg";
property="Polynomial";
value= "N";
output;
id= "Reg";
property="PolynomialDegree";
value= "2";
output;
id= "Reg";
property="Terms";
value= "N";
output;
id= "Reg";
property="Error";
value= "LOGISTIC";
output;
id= "Reg";
property="LinkFunction";
value= "LOGIT";
output;
id= "Reg";
property="SuppressIntercept";
value= "N";
output;
id= "Reg";
property="InputCoding";
value= "DEVIATION";
output;
id= "Reg";
property="MinResourceUse";
value= "N";
output;
id= "Reg";
property="ModelSelection";
value= "NONE";
output;
id= "Reg";
property="SelectionCriterion";
value= "DEFAULT";
output;
id= "Reg";
property="SelectionDefault";
value= "Y";
output;
id= "Reg";
property="Sequential";
value= "N";
output;
id= "Reg";
property="SlEntry";
value= "0.05";
output;
id= "Reg";
property="SlStay";
value= "0.05";
output;
id= "Reg";
property="Start";
value= "0";
output;
id= "Reg";
property="Stop";
value= "0";
output;
id= "Reg";
property="Force";
value= "0";
output;
id= "Reg";
property="Hierarchy";
value= "CLASS";
output;
id= "Reg";
property="Rule";
value= "NONE";
output;
id= "Reg";
property="MaxStep";
value= ".";
output;
id= "Reg";
property="StepOutput";
value= "N";
output;
id= "Reg";
property="OptimizationTechnique";
value= "DEFAULT";
output;
id= "Reg";
property="ModelDefaults";
value= "Y";
output;
id= "Reg";
property="MaxIterations";
value= ".";
output;
id= "Reg";
property="MaxFunctionCalls";
value= ".";
output;
id= "Reg";
property="MaxCPUTime";
value= "1 HOUR";
output;
id= "Reg";
property="ConvDefaults";
value= "Y";
output;
id= "Reg";
property="AbsConvValue";
value= "-1.34078E154";
output;
id= "Reg";
property="AbsFValue";
value= "0";
output;
id= "Reg";
property="AbsFTime";
value= "1";
output;
id= "Reg";
property="AbsGValue";
value= "0.00001";
output;
id= "Reg";
property="AbsGTime";
value= "1";
output;
id= "Reg";
property="AbsXValue";
value= "1E-8";
output;
id= "Reg";
property="AbsXTime";
value= "1";
output;
id= "Reg";
property="FConvValue";
value= "0";
output;
id= "Reg";
property="FConvTimes";
value= "1";
output;
id= "Reg";
property="GConvValue";
value= "1E-6";
output;
id= "Reg";
property="GConvTimes";
value= "1";
output;
id= "Reg";
property="ClParm";
value= "N";
output;
id= "Reg";
property="Covout";
value= "N";
output;
id= "Reg";
property="CovB";
value= "N";
output;
id= "Reg";
property="CorB";
value= "N";
output;
id= "Reg";
property="Simple";
value= "N";
output;
id= "Reg";
property="SuppressOutput";
value= "N";
output;
id= "Reg";
property="Details";
value= "N";
output;
id= "Reg";
property="PrintDesignMatrix";
value= "N";
output;
id= "Reg";
property="SASSPDS";
value= "N";
output;
id= "Reg";
property="Performance";
value= "N";
output;
id= "Reg";
property="ExcludedVariable";
value= "REJECT";
output;
id= "Reg";
property="ForceRun";
value= "N";
output;
id= "Reg";
property="RunAction";
value= "Train";
output;
id= "Reg";
property="Component";
value= "Regression";
output;
id= "Reg";
property="Interactions";
value= "";
output;
id= "Reg";
property="EM_DECMETA_AmtThisYear";
value= "WORK.Reg_AmtThisYear_DM";
output;
id= "Reg";
property="EM_DECDATA_AmtThisYear";
value= "WORK.Reg_AmtThisYear_DD";
output;
id= "Reg";
property="EM_FILE_EMNOTES";
value= "Reg_EMNOTES.txt";
output;
id= "Part";
property="Method";
value= "DEFAULT";
output;
id= "Part";
property="TrainPct";
value= "20";
output;
id= "Part";
property="ValidatePct";
value= "80";
output;
id= "Part";
property="TestPct";
value= "0";
output;
id= "Part";
property="RandomSeed";
value= "12345";
output;
id= "Part";
property="OutputType";
value= "DATA";
output;
id= "Part";
property="IntervalDistribution";
value= "Y";
output;
id= "Part";
property="ClassDistribution";
value= "Y";
output;
id= "Part";
property="ForceRun";
value= "N";
output;
id= "Part";
property="RunAction";
value= "Train";
output;
id= "Part";
property="Component";
value= "Partition";
output;
id= "Part";
property="EM_FILE_EMNOTES";
value= "Part_EMNOTES.txt";
output;
id= "Merge2";
property="MergeType";
value= "ONETOONE";
output;
id= "Merge2";
property="OverwriteVariables";
value= "N";
output;
id= "Merge2";
property="OverwritePredicted";
value= "N";
output;
id= "Merge2";
property="OverwriteResidual";
value= "N";
output;
id= "Merge2";
property="OverwriteClassification";
value= "N";
output;
id= "Merge2";
property="OverwriteAssess";
value= "N";
output;
id= "Merge2";
property="OverwriteSegment";
value= "N";
output;
id= "Merge2";
property="ForceRun";
value= "N";
output;
id= "Merge2";
property="RunAction";
value= "Train";
output;
id= "Merge2";
property="Component";
value= "Merge";
output;
id= "Merge2";
property="EM_FILE_EMNOTES";
value= "Merge2_EMNOTES.txt";
output;
id= "Merge";
property="MergeType";
value= "ONETOONE";
output;
id= "Merge";
property="OverwriteVariables";
value= "N";
output;
id= "Merge";
property="OverwritePredicted";
value= "N";
output;
id= "Merge";
property="OverwriteResidual";
value= "N";
output;
id= "Merge";
property="OverwriteClassification";
value= "N";
output;
id= "Merge";
property="OverwriteAssess";
value= "N";
output;
id= "Merge";
property="OverwriteSegment";
value= "N";
output;
id= "Merge";
property="ForceRun";
value= "N";
output;
id= "Merge";
property="RunAction";
value= "Train";
output;
id= "Merge";
property="Component";
value= "Merge";
output;
id= "Merge";
property="EM_FILE_EMNOTES";
value= "Merge_EMNOTES.txt";
output;
id= "MdlComp";
property="NumberOfReportedLevels";
value= "1E-6";
output;
id= "MdlComp";
property="NormalizeReportingVariables";
value= "Y";
output;
id= "MdlComp";
property="DecileBin";
value= "20";
output;
id= "MdlComp";
property="LiftEpsilon";
value= "1E-6";
output;
id= "MdlComp";
property="ProfitEpsilon";
value= "1E-6";
output;
id= "MdlComp";
property="RoiEpsilon";
value= "1E-6";
output;
id= "MdlComp";
property="ScoreDistBin";
value= "20";
output;
id= "MdlComp";
property="RocChart";
value= "Y";
output;
id= "MdlComp";
property="RocEpsilon";
value= "0.01";
output;
id= "MdlComp";
property="AssessAllTargetLevels";
value= "N";
output;
id= "MdlComp";
property="SelectionData";
value= "DEFAULT";
output;
id= "MdlComp";
property="HPCriteria";
value= "DEFAULT";
output;
id= "MdlComp";
property="intervalViyaCriteria";
value= "DEFAULT";
output;
id= "MdlComp";
property="classViyaCriteria";
value= "DEFAULT";
output;
id= "MdlComp";
property="SelectionTable";
value= "TRAIN";
output;
id= "MdlComp";
property="SelectionCriteria";
value= "DEFAULT";
output;
id= "MdlComp";
property="SelectionDepth";
value= "10";
output;
id= "MdlComp";
property="NumberofBins";
value= "20";
output;
id= "MdlComp";
property="RecomputeAssess";
value= "N";
output;
id= "MdlComp";
property="TargetName";
value= "AmtThisYear";
output;
id= "MdlComp";
property="ModelId";
value= "AutoNeural";
output;
id= "MdlComp";
property="ModelDescription";
value= "AutoNeural";
output;
id= "MdlComp";
property="ModelCriteria";
value= "Valid: Average Squared Error";
output;
id= "MdlComp";
property="ForceRun";
value= "N";
output;
id= "MdlComp";
property="RunAction";
value= "Train";
output;
id= "MdlComp";
property="Component";
value= "ModelCompare";
output;
id= "MdlComp";
property="StatisticUsed";
value= "_VASE_";
output;
id= "MdlComp";
property="TargetLabel";
value= "";
output;
id= "MdlComp";
property="EM_FILE_EMNOTES";
value= "MdlComp_EMNOTES.txt";
output;
id= "Impt";
property="MethodInterval";
value= "MEAN";
output;
id= "Impt";
property="MethodClass";
value= "COUNT";
output;
id= "Impt";
property="MethodTargetInterval";
value= "NONE";
output;
id= "Impt";
property="MethodTargetClass";
value= "NONE";
output;
id= "Impt";
property="ABWTuning";
value= "9";
output;
id= "Impt";
property="AHUBERTuning";
value= "1.5";
output;
id= "Impt";
property="AWAVETuning";
value= "6.2831853072";
output;
id= "Impt";
property="SpacingProportion";
value= "90";
output;
id= "Impt";
property="DefaultChar";
value= "";
output;
id= "Impt";
property="DefaultNum";
value= ".";
output;
id= "Impt";
property="RandomSeed";
value= "12345";
output;
id= "Impt";
property="Normalize";
value= "Y";
output;
id= "Impt";
property="ImputeNoMissing";
value= "N";
output;
id= "Impt";
property="MaxPctMissing";
value= "50";
output;
id= "Impt";
property="ValidateTestMissing";
value= "N";
output;
id= "Impt";
property="DistributionMissing";
value= "N";
output;
id= "Impt";
property="LeafSize";
value= "5";
output;
id= "Impt";
property="Maxbranch";
value= "2";
output;
id= "Impt";
property="Maxdepth";
value= "6";
output;
id= "Impt";
property="MinCatSize";
value= "5";
output;
id= "Impt";
property="Nrules";
value= "5";
output;
id= "Impt";
property="Nsurrs";
value= "2";
output;
id= "Impt";
property="Splitsize";
value= ".";
output;
id= "Impt";
property="Indicator";
value= "NONE";
output;
id= "Impt";
property="IndicatorRole";
value= "REJECTED";
output;
id= "Impt";
property="ReplaceVariable";
value= "N";
output;
id= "Impt";
property="HideVariable";
value= "Y";
output;
id= "Impt";
property="IndicatorSource";
value= "IMPUTED";
output;
id= "Impt";
property="ForceRun";
value= "N";
output;
id= "Impt";
property="RunAction";
value= "Train";
output;
id= "Impt";
property="Component";
value= "Impute";
output;
id= "Impt";
property="EM_FILE_EMNOTES";
value= "Impt_EMNOTES.txt";
output;
id= "Ids4";
property="DataSource";
value= "scorerd";
output;
id= "Ids4";
property="Scope";
value= "LOCAL";
output;
id= "Ids4";
property="Role";
value= "SCORE";
output;
%let Ids4_lib = %scan(&Ids4_data, 1, .);
id= "Ids4";
property="Library";
value= "&Ids4_lib";
output;
%let Ids4_member = %scan(&Ids4_data, 2, .);
id= "Ids4";
property="Table";
value= "&Ids4_member";
output;
id= "Ids4";
property="NCols";
value= "3";
output;
id= "Ids4";
property="NObs";
value= "1000000";
output;
id= "Ids4";
property="NBytes";
value= "24183808";
output;
id= "Ids4";
property="Segment";
value= "";
output;
id= "Ids4";
property="DataSourceRole";
value= "SCORE";
output;
id= "Ids4";
property="OutputType";
value= "VIEW";
output;
id= "Ids4";
property="ForceRun";
value= "N";
output;
id= "Ids4";
property="ComputeStatistics";
value= "N";
output;
id= "Ids4";
property="DataSelection";
value= "&Ids4_source";
output;
id= "Ids4";
property="NewTable";
value= "&Ids4_newdata";
output;
id= "Ids4";
property="MetaAdvisor";
value= "BASIC";
output;
id= "Ids4";
property="ApplyIntervalLevelLowerLimit";
value= "Y";
output;
id= "Ids4";
property="IntervalLowerLimit";
value= "20";
output;
id= "Ids4";
property="ApplyMaxPercentMissing";
value= "Y";
output;
id= "Ids4";
property="MaxPercentMissing";
value= "50";
output;
id= "Ids4";
property="ApplyMaxClassLevels";
value= "Y";
output;
id= "Ids4";
property="MaxClassLevels";
value= "20";
output;
id= "Ids4";
property="IdentifyEmptyColumns";
value= "Y";
output;
id= "Ids4";
property="VariableValidation";
value= "STRICT";
output;
id= "Ids4";
property="NewVariableRole";
value= "REJECT";
output;
id= "Ids4";
property="DropMapVariables";
value= "Y";
output;
id= "Ids4";
property="DsId";
value= "scorerd";
output;
id= "Ids4";
property="DsSampleName";
value= "";
output;
id= "Ids4";
property="DsSampleSizeType";
value= "";
output;
id= "Ids4";
property="DsSampleSize";
value= "";
output;
id= "Ids4";
property="DsCreatedBy";
value= "11131726";
output;
id= "Ids4";
property="DsCreateDate";
value= "1864294749.1";
output;
id= "Ids4";
property="DsModifiedBy";
value= "11131726";
output;
id= "Ids4";
property="DsModifyDate";
value= "1864294749.2";
output;
id= "Ids4";
property="DsScope";
value= "LOCAL";
output;
id= "Ids4";
property="Sample";
value= "D";
output;
id= "Ids4";
property="SampleSizeType";
value= "PERCENT";
output;
id= "Ids4";
property="SampleSizePercent";
value= "20";
output;
id= "Ids4";
property="SampleSizeObs";
value= "10000";
output;
id= "Ids4";
property="DBPassThrough";
value= "Y";
output;
id= "Ids4";
property="RunAction";
value= "Train";
output;
id= "Ids4";
property="Component";
value= "DataSource";
output;
id= "Ids4";
property="Description";
value= "";
output;
id= "Ids4";
property="EM_FILE_EMNOTES";
value= "Ids4_EMNOTES.txt";
output;
id= "Ids3";
property="DataSource";
value= "targetrdamount";
output;
id= "Ids3";
property="Scope";
value= "LOCAL";
output;
id= "Ids3";
property="Role";
value= "RAW";
output;
%let Ids3_lib = %scan(&Ids3_data, 1, .);
id= "Ids3";
property="Library";
value= "&Ids3_lib";
output;
%let Ids3_member = %scan(&Ids3_data, 2, .);
id= "Ids3";
property="Table";
value= "&Ids3_member";
output;
id= "Ids3";
property="NCols";
value= "3";
output;
id= "Ids3";
property="NObs";
value= "1000000";
output;
id= "Ids3";
property="NBytes";
value= "24183808";
output;
id= "Ids3";
property="Segment";
value= "";
output;
id= "Ids3";
property="DataSourceRole";
value= "RAW";
output;
id= "Ids3";
property="OutputType";
value= "VIEW";
output;
id= "Ids3";
property="ForceRun";
value= "N";
output;
id= "Ids3";
property="ComputeStatistics";
value= "N";
output;
id= "Ids3";
property="DataSelection";
value= "&Ids3_source";
output;
id= "Ids3";
property="NewTable";
value= "&Ids3_newdata";
output;
id= "Ids3";
property="MetaAdvisor";
value= "BASIC";
output;
id= "Ids3";
property="ApplyIntervalLevelLowerLimit";
value= "Y";
output;
id= "Ids3";
property="IntervalLowerLimit";
value= "20";
output;
id= "Ids3";
property="ApplyMaxPercentMissing";
value= "Y";
output;
id= "Ids3";
property="MaxPercentMissing";
value= "50";
output;
id= "Ids3";
property="ApplyMaxClassLevels";
value= "Y";
output;
id= "Ids3";
property="MaxClassLevels";
value= "20";
output;
id= "Ids3";
property="IdentifyEmptyColumns";
value= "Y";
output;
id= "Ids3";
property="VariableValidation";
value= "STRICT";
output;
id= "Ids3";
property="NewVariableRole";
value= "REJECT";
output;
id= "Ids3";
property="DropMapVariables";
value= "Y";
output;
id= "Ids3";
property="DsId";
value= "targetrdamount";
output;
id= "Ids3";
property="DsSampleName";
value= "";
output;
id= "Ids3";
property="DsSampleSizeType";
value= "";
output;
id= "Ids3";
property="DsSampleSize";
value= "";
output;
id= "Ids3";
property="DsCreatedBy";
value= "11131726";
output;
id= "Ids3";
property="DsCreateDate";
value= "1864293934.7";
output;
id= "Ids3";
property="DsModifiedBy";
value= "11131726";
output;
id= "Ids3";
property="DsModifyDate";
value= "1864293934.7";
output;
id= "Ids3";
property="DsScope";
value= "LOCAL";
output;
id= "Ids3";
property="Sample";
value= "D";
output;
id= "Ids3";
property="SampleSizeType";
value= "PERCENT";
output;
id= "Ids3";
property="SampleSizePercent";
value= "20";
output;
id= "Ids3";
property="SampleSizeObs";
value= "10000";
output;
id= "Ids3";
property="DBPassThrough";
value= "Y";
output;
id= "Ids3";
property="RunAction";
value= "Train";
output;
id= "Ids3";
property="Component";
value= "DataSource";
output;
id= "Ids3";
property="Description";
value= "";
output;
id= "Ids3";
property="EM_VARIABLEATTRIBUTES";
value= "WORK.Ids3_VariableAttribute";
output;
id= "Ids3";
property="EM_DECMETA_AmtThisYear";
value= "WORK.Ids3_AmtThisYear_DM";
output;
id= "Ids3";
property="EM_DECDATA_AmtThisYear";
value= "WORK.Ids3_AmtThisYear_DD";
output;
id= "Ids3";
property="EM_FILE_EMNOTES";
value= "Ids3_EMNOTES.txt";
output;
id= "Ids2";
property="DataSource";
value= "score";
output;
id= "Ids2";
property="Scope";
value= "LOCAL";
output;
id= "Ids2";
property="Role";
value= "SCORE";
output;
%let Ids2_lib = %scan(&Ids2_data, 1, .);
id= "Ids2";
property="Library";
value= "&Ids2_lib";
output;
%let Ids2_member = %scan(&Ids2_data, 2, .);
id= "Ids2";
property="Table";
value= "&Ids2_member";
output;
id= "Ids2";
property="NCols";
value= "17";
output;
id= "Ids2";
property="NObs";
value= "1000000";
output;
id= "Ids2";
property="NBytes";
value= "168494080";
output;
id= "Ids2";
property="Segment";
value= "";
output;
id= "Ids2";
property="DataSourceRole";
value= "SCORE";
output;
id= "Ids2";
property="OutputType";
value= "VIEW";
output;
id= "Ids2";
property="ForceRun";
value= "N";
output;
id= "Ids2";
property="ComputeStatistics";
value= "N";
output;
id= "Ids2";
property="DataSelection";
value= "&Ids2_source";
output;
id= "Ids2";
property="NewTable";
value= "&Ids2_newdata";
output;
id= "Ids2";
property="MetaAdvisor";
value= "BASIC";
output;
id= "Ids2";
property="ApplyIntervalLevelLowerLimit";
value= "Y";
output;
id= "Ids2";
property="IntervalLowerLimit";
value= "20";
output;
id= "Ids2";
property="ApplyMaxPercentMissing";
value= "Y";
output;
id= "Ids2";
property="MaxPercentMissing";
value= "50";
output;
id= "Ids2";
property="ApplyMaxClassLevels";
value= "Y";
output;
id= "Ids2";
property="MaxClassLevels";
value= "20";
output;
id= "Ids2";
property="IdentifyEmptyColumns";
value= "Y";
output;
id= "Ids2";
property="VariableValidation";
value= "STRICT";
output;
id= "Ids2";
property="NewVariableRole";
value= "REJECT";
output;
id= "Ids2";
property="DropMapVariables";
value= "Y";
output;
id= "Ids2";
property="DsId";
value= "score";
output;
id= "Ids2";
property="DsSampleName";
value= "";
output;
id= "Ids2";
property="DsSampleSizeType";
value= "";
output;
id= "Ids2";
property="DsSampleSize";
value= "";
output;
id= "Ids2";
property="DsCreatedBy";
value= "11131726";
output;
id= "Ids2";
property="DsCreateDate";
value= "1864293868.3";
output;
id= "Ids2";
property="DsModifiedBy";
value= "11131726";
output;
id= "Ids2";
property="DsModifyDate";
value= "1864293868.4";
output;
id= "Ids2";
property="DsScope";
value= "LOCAL";
output;
id= "Ids2";
property="Sample";
value= "D";
output;
id= "Ids2";
property="SampleSizeType";
value= "PERCENT";
output;
id= "Ids2";
property="SampleSizePercent";
value= "20";
output;
id= "Ids2";
property="SampleSizeObs";
value= "10000";
output;
id= "Ids2";
property="DBPassThrough";
value= "Y";
output;
id= "Ids2";
property="RunAction";
value= "Train";
output;
id= "Ids2";
property="Component";
value= "DataSource";
output;
id= "Ids2";
property="Description";
value= "";
output;
id= "Ids2";
property="EM_VARIABLEATTRIBUTES";
value= "WORK.Ids2_VariableAttribute";
output;
id= "Ids2";
property="EM_FILE_EMNOTES";
value= "Ids2_EMNOTES.txt";
output;
id= "Ids";
property="DataSource";
value= "hist";
output;
id= "Ids";
property="Scope";
value= "LOCAL";
output;
id= "Ids";
property="Role";
value= "RAW";
output;
%let Ids_lib = %scan(&Ids_data, 1, .);
id= "Ids";
property="Library";
value= "&Ids_lib";
output;
%let Ids_member = %scan(&Ids_data, 2, .);
id= "Ids";
property="Table";
value= "&Ids_member";
output;
id= "Ids";
property="NCols";
value= "19";
output;
id= "Ids";
property="NObs";
value= "1000000";
output;
id= "Ids";
property="NBytes";
value= "184615936";
output;
id= "Ids";
property="Segment";
value= "";
output;
id= "Ids";
property="DataSourceRole";
value= "RAW";
output;
id= "Ids";
property="OutputType";
value= "VIEW";
output;
id= "Ids";
property="ForceRun";
value= "N";
output;
id= "Ids";
property="ComputeStatistics";
value= "N";
output;
id= "Ids";
property="DataSelection";
value= "&Ids_source";
output;
id= "Ids";
property="NewTable";
value= "&Ids_newdata";
output;
id= "Ids";
property="MetaAdvisor";
value= "BASIC";
output;
id= "Ids";
property="ApplyIntervalLevelLowerLimit";
value= "Y";
output;
id= "Ids";
property="IntervalLowerLimit";
value= "20";
output;
id= "Ids";
property="ApplyMaxPercentMissing";
value= "Y";
output;
id= "Ids";
property="MaxPercentMissing";
value= "50";
output;
id= "Ids";
property="ApplyMaxClassLevels";
value= "Y";
output;
id= "Ids";
property="MaxClassLevels";
value= "20";
output;
id= "Ids";
property="IdentifyEmptyColumns";
value= "Y";
output;
id= "Ids";
property="VariableValidation";
value= "STRICT";
output;
id= "Ids";
property="NewVariableRole";
value= "REJECT";
output;
id= "Ids";
property="DropMapVariables";
value= "Y";
output;
id= "Ids";
property="DsId";
value= "hist";
output;
id= "Ids";
property="DsSampleName";
value= "";
output;
id= "Ids";
property="DsSampleSizeType";
value= "";
output;
id= "Ids";
property="DsSampleSize";
value= "";
output;
id= "Ids";
property="DsCreatedBy";
value= "11131726";
output;
id= "Ids";
property="DsCreateDate";
value= "1864293809.3";
output;
id= "Ids";
property="DsModifiedBy";
value= "11131726";
output;
id= "Ids";
property="DsModifyDate";
value= "1864293809.4";
output;
id= "Ids";
property="DsScope";
value= "LOCAL";
output;
id= "Ids";
property="Sample";
value= "D";
output;
id= "Ids";
property="SampleSizeType";
value= "PERCENT";
output;
id= "Ids";
property="SampleSizePercent";
value= "20";
output;
id= "Ids";
property="SampleSizeObs";
value= "10000";
output;
id= "Ids";
property="DBPassThrough";
value= "Y";
output;
id= "Ids";
property="RunAction";
value= "Train";
output;
id= "Ids";
property="Component";
value= "DataSource";
output;
id= "Ids";
property="Description";
value= "";
output;
id= "Ids";
property="EM_VARIABLEATTRIBUTES";
value= "WORK.Ids_VariableAttribute";
output;
id= "Ids";
property="EM_FILE_EMNOTES";
value= "Ids_EMNOTES.txt";
output;
id= "EMCODE";
property="UsePriors";
value= "Y";
output;
id= "EMCODE";
property="ToolType";
value= "UTILITY";
output;
id= "EMCODE";
property="DataNeeded";
value= "N";
output;
id= "EMCODE";
property="PublishCode";
value= "PUBLISH";
output;
id= "EMCODE";
property="ScoreCodeFormat";
value= "DATASTEP";
output;
id= "EMCODE";
property="MetaAdvisor";
value= "BASIC";
output;
id= "EMCODE";
property="ForceRun";
value= "N";
output;
id= "EMCODE";
property="RunAction";
value= "Train";
output;
id= "EMCODE";
property="Component";
value= "SASCode";
output;
id= "EMCODE";
property="ToolPrefix";
value= "EMCODE";
output;
id= "EMCODE";
property="EM_FILE_USERTRAINCODE";
value= "EMCODE_USERTRAINCODE.sas";
output;
id= "EMCODE";
property="EM_FILE_USERREPORTCODE";
value= "EMCODE_USERREPORTCODE.sas";
output;
id= "EMCODE";
property="EM_FILE_EMNOTES";
value= "EMCODE_EMNOTES.txt";
output;
id= "AutoNeural";
property="Architecture";
value= "SINGLE LAYER";
output;
id= "AutoNeural";
property="TrainAction";
value= "SEARCH";
output;
id= "AutoNeural";
property="Termination";
value= "OVERFITTING";
output;
id= "AutoNeural";
property="TargetError";
value= "DEFAULT";
output;
id= "AutoNeural";
property="Hidden";
value= "2";
output;
id= "AutoNeural";
property="TotalHidden";
value= "30";
output;
id= "AutoNeural";
property="MaxIter";
value= "8";
output;
id= "AutoNeural";
property="AdjustIterations";
value= "Y";
output;
id= "AutoNeural";
property="FinalTrain";
value= "Y";
output;
id= "AutoNeural";
property="FinalIter";
value= "5";
output;
id= "AutoNeural";
property="TotalTime";
value= "1 HOUR";
output;
id= "AutoNeural";
property="Freeze";
value= "N";
output;
id= "AutoNeural";
property="Direct";
value= "Y";
output;
id= "AutoNeural";
property="Tanh";
value= "Y";
output;
id= "AutoNeural";
property="Normal";
value= "Y";
output;
id= "AutoNeural";
property="Sine";
value= "Y";
output;
id= "AutoNeural";
property="Exponential";
value= "N";
output;
id= "AutoNeural";
property="Identity";
value= "N";
output;
id= "AutoNeural";
property="Logistic";
value= "N";
output;
id= "AutoNeural";
property="Reciprocal";
value= "N";
output;
id= "AutoNeural";
property="Softmax";
value= "N";
output;
id= "AutoNeural";
property="Square";
value= "N";
output;
id= "AutoNeural";
property="Tolerance";
value= "MEDIUM";
output;
id= "AutoNeural";
property="Residuals";
value= "Y";
output;
id= "AutoNeural";
property="Standardizations";
value= "N";
output;
id= "AutoNeural";
property="HiddenUnits";
value= "N";
output;
id= "AutoNeural";
property="outfit";
value= "";
output;
id= "AutoNeural";
property="weights";
value= "";
output;
id= "AutoNeural";
property="estds";
value= "";
output;
id= "AutoNeural";
property="Bestds";
value= "";
output;
id= "AutoNeural";
property="HistoryDs";
value= "";
output;
id= "AutoNeural";
property="ForceRun";
value= "N";
output;
id= "AutoNeural";
property="RunAction";
value= "Train";
output;
id= "AutoNeural";
property="Component";
value= "AutoNeural";
output;
id= "AutoNeural";
property="EM_DECMETA_AmtThisYear";
value= "WORK.AutoNeural_AmtThisYear_DM";
output;
id= "AutoNeural";
property="EM_DECDATA_AmtThisYear";
value= "WORK.AutoNeural_AmtThisYear_DD";
output;
id= "AutoNeural";
property="EM_FILE_EMNOTES";
value= "AutoNeural_EMNOTES.txt";
output;
run;
*------------------------------------------------------------*;
* Create connections data set;
*------------------------------------------------------------*;
data connect;
length from to $12;
from="Trans";
to="Impt";
output;
from="Impt";
to="Part";
output;
from="Merge";
to="Trans";
output;
from="Ids2";
to="Merge2";
output;
from="Merge2";
to="Score";
output;
from="Ids4";
to="Merge2";
output;
from="Ids3";
to="Merge";
output;
from="Ids";
to="Merge";
output;
from="Score";
to="EMCODE";
output;
from="MdlComp";
to="Score";
output;
from="Reg";
to="MdlComp";
output;
from="Tree";
to="MdlComp";
output;
from="AutoNeural";
to="MdlComp";
output;
from="Part";
to="AutoNeural";
output;
from="Part";
to="Tree";
output;
from="Part";
to="Reg";
output;
run;
*------------------------------------------------------------*;
* Create actions to run data set;
*------------------------------------------------------------*;
%macro emaction;
%let actionstring = %upcase(&EM_ACTION);
%if %index(&actionstring, RUN) or %index(&actionstring, REPORT) %then %do;
data actions;
length id $12 action $40;
id="EMCODE";
%if %index(&actionstring, RUN) %then %do;
action='run';
output;
%end;
%if %index(&actionstring, REPORT) %then %do;
action='report';
output;
%end;
run;
%end;
%mend;
%emaction;
*------------------------------------------------------------*;
* Execute the actions;
*------------------------------------------------------------*;
%em5batch(execute, workspace=workspace, nodes=nodes, connect=connect, datasources=datasources, nodeprops=nodeprops, action=actions);
